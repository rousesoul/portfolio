<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>房地产中介需求调研问卷 - Linda Yu</title>
    <style>
        /* Global Styles & Material 3 Inspired Theme - Refined for Linda */
        :root {
            --linda-primary-color: #D35400; /* A warm, inviting yet professional orange/coral */
            --linda-primary-rgb: 211, 84, 0;
            --linda-on-primary-color: #ffffff;
            
            --linda-secondary-color: #7D3C98; /* A softer, elegant purple as secondary */
            --linda-secondary-rgb: 125, 60, 152;

            --linda-surface-color: #FFFAF0; /* FloralWhite - warm, very light off-white */
            --linda-surface-container-highest: #FFFFFF; /* Pure white for cards for contrast */
            --linda-on-surface-color: #342D26; /* Dark brown/grey for text - softer than pure black */
            
            --linda-outline-color: #C5BBAF; /* Softer outline */
            --linda-label-color: #5C5046; /* Muted text for labels */
            
            --m3-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --m3-border-radius: 12px; /* Consistent softer radius */
            --m3-large-border-radius: 20px; /* More rounded for larger elements */
        }

        body {
            font-family: var(--m3-font-family);
            line-height: 1.7; 
            margin: 0;
            padding: 0;
            background-color: var(--linda-surface-color); 
            color: var(--linda-on-surface-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-bottom: 50px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            margin: 40px auto; 
            padding: 30px 35px 45px 35px; 
            background-color: var(--linda-surface-container-highest);
            border-radius: var(--m3-large-border-radius); 
            box-shadow: 0 3px 6px rgba(0,0,0,0.05), 0 5px 15px rgba(0,0,0,0.07); 
        }

        header {
            text-align: center;
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--linda-outline-color);
        }

        header h1 {
            font-size: 28px; 
            font-weight: 600;
            color: var(--linda-primary-color); 
            margin-bottom: 12px;
        }

        header p {
            font-size: 16px;
            color: var(--linda-label-color);
        }

        .survey-form h2 {
            font-size: 22px; 
            font-weight: 500;
            color: var(--linda-secondary-color); 
            margin-top: 35px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(var(--linda-secondary-rgb), 0.2); 
        }

        .question-block {
            margin-bottom: 30px;
            padding: 25px;
            background-color: #fff; 
            border-radius: var(--m3-border-radius);
            border: 1px solid #EAE0D5; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }

        .question-block label.main-label {
            display: block;
            font-size: 17px; 
            font-weight: 500; 
            color: var(--linda-on-surface-color);
            margin-bottom: 16px;
        }
        .question-block label.main-label small {
            font-weight: 400;
            font-size: 13px;
            color: var(--linda-label-color);
            display: block;
            margin-top: 4px;
        }


        .option-group label {
            display: flex;
            align-items: center;
            font-size: 15px; 
            color: var(--linda-label-color);
            margin-bottom: 12px;
            padding: 14px 18px; 
            border-radius: var(--m3-border-radius);
            background-color: #FCFBF9; 
            border: 1px solid var(--linda-outline-color);
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }
        .option-group label:hover {
            background-color: rgba(var(--linda-primary-rgb), 0.08); 
            border-color: var(--linda-primary-color);
            box-shadow: 0 0 8px rgba(var(--linda-primary-rgb), 0.1);
        }
         .option-group label:has(input:checked) { 
            border-color: var(--linda-primary-color);
            background-color: rgba(var(--linda-primary-rgb), 0.12); 
            color: var(--linda-primary-color); 
            font-weight: 500;
        }


        .option-group input[type="checkbox"],
        .option-group input[type="radio"] {
            margin-right: 14px;
            width: 20px; 
            height: 20px;
            accent-color: var(--linda-primary-color);
            appearance: none;
            -webkit-appearance: none;
            border: 2px solid var(--linda-outline-color);
            border-radius: 6px; 
            position: relative;
            cursor: pointer;
            vertical-align: middle;
            transition: border-color 0.2s ease, background-color 0.2s ease;
        }
        .option-group input[type="radio"] {
            border-radius: 50%; 
        }
        .option-group input[type="checkbox"]:hover,
        .option-group input[type="radio"]:hover {
            border-color: var(--linda-primary-color);
        }
        .option-group input[type="checkbox"]:checked,
        .option-group input[type="radio"]:checked {
            background-color: var(--linda-primary-color);
            border-color: var(--linda-primary-color);
        }
        .option-group input[type="checkbox"]:checked::before {
            content: "✔";
            font-size: 14px;
            color: var(--linda-on-primary-color);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            line-height: 1;
        }
        .option-group input[type="radio"]:checked::before {
            content: "";
            display: block;
            width: 10px; 
            height: 10px;
            background-color: var(--linda-on-primary-color);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }


        textarea,
        input[type="text"].other-text {
            width: 100%; 
            padding: 16px 18px; 
            font-size: 16px; 
            border: 1px solid var(--linda-outline-color);
            border-radius: var(--m3-border-radius); 
            background-color: #fff; 
            box-sizing: border-box;
            margin-top: 8px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            color: var(--linda-on-surface-color);
        }
        textarea::placeholder,
        input[type="text"].other-text::placeholder {
            color: var(--linda-label-color);
            opacity: 0.8;
        }
        textarea:focus,
        input[type="text"].other-text:focus {
            border-color: var(--linda-primary-color);
            box-shadow: 0 0 0 3px rgba(var(--linda-primary-rgb), 0.2);
            outline: none;
        }
        textarea {
            min-height: 140px; 
            resize: vertical;
        }
        .option-group label input[type="text"].other-text {
            margin-left: 10px;
            flex-grow: 1;
            padding: 12px 14px; 
            font-size: 15px;
        }


        .buttons-container {
            margin-top: 45px;
            display: flex;
            flex-wrap: wrap; 
            justify-content: flex-end;
            gap: 12px; 
        }
        .buttons-container p.submission-note {
            width: 100%;
            text-align: right;
            font-size: 13px;
            color: var(--linda-label-color);
            margin-bottom: 8px; 
        }

        .button {
            padding: 10px 20px; 
            font-size: 14px; 
            font-weight: 500;
            border: none;
            border-radius: 20px; 
            cursor: pointer;
            transition: background-color 0.25s ease, box-shadow 0.25s ease, transform 0.1s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 40px; 
            line-height: 1.2; 
        }
        .button:active {
            transform: translateY(1px); 
        }
        .button svg {
            margin-right: 8px; 
            width: 18px;
            height: 18px;
        }

        .button-primary { /* This will be for Download HTML */
            background-color: var(--linda-primary-color);
            color: var(--linda-on-primary-color);
            box-shadow: 0 2px 4px rgba(var(--linda-primary-rgb), 0.25), 0 3px 8px rgba(var(--linda-primary-rgb), 0.2);
        }
        .button-primary:hover {
            background-color: #B84900; 
            box-shadow: 0 3px 6px rgba(var(--linda-primary-rgb), 0.3), 0 5px 12px rgba(var(--linda-primary-rgb), 0.25);
        }

        .button-secondary {
            color: var(--linda-primary-color); 
            border: 2px solid var(--linda-outline-color);
            background-color: transparent; 
        }
        .button-secondary:hover {
            background-color: rgba(var(--linda-primary-rgb), 0.08); 
            border-color: var(--linda-primary-color);
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 25px;
            border-top: 1px solid var(--linda-outline-color);
            font-size: 14px;
            color: var(--linda-label-color);
        }

        /* Styles for the generated HTML reply page */
        .survey-reply-body { background-color: #fdfaf6; padding: 20px; font-family: var(--m3-font-family); color: var(--linda-on-surface-color); }
        .survey-reply-container { max-width: 800px; margin: 20px auto; background-color: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .survey-reply-header h1 { color: var(--linda-primary-color); font-size: 24px; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom:10px; }
        .survey-reply-section h2 { color: var(--linda-secondary-color); font-size: 18px; margin-top: 20px; margin-bottom: 10px; }
        .survey-reply-question { font-weight: bold; margin-top: 15px; color: var(--linda-on-surface-color); }
        .survey-reply-answer { margin-left: 20px; margin-bottom: 10px; color: #555; white-space: pre-wrap; word-wrap: break-word; }
        .survey-reply-answer.empty { color: #999; font-style: italic; }


        /* Print Styles */
        @media print {
            body { background-color: #fff; padding: 0; margin: 0; font-size: 11pt; color: #000 !important; }
            :root { --linda-primary-color: #000000; --linda-outline-color: #777777; --linda-secondary-color: #000000; }
            .container { box-shadow: none; border: none; width: 100%; max-width: 100%; margin: 0; padding: 10px; }
            header h1 { font-size: 18pt; color: #000 !important; }
            header p { font-size: 10pt; color: #333 !important; }
            .survey-form h2 { font-size: 13pt; color: #000 !important; border-bottom: 1px solid #aaa; }
            .question-block { padding: 8px 0; border: none; background-color: #fff !important; page-break-inside: avoid; }
            .question-block label.main-label { font-size: 11pt; font-weight: bold; color: #000 !important; }
            .option-group label { font-size: 10pt; padding: 4px; border: 1px solid #aaa !important; background-color: #fff !important; color: #000 !important; }
            
            .option-group input[type="checkbox"], .option-group input[type="radio"] {
                margin-right: 8px; appearance: none; -webkit-appearance: none;
                border: 1px solid #333 !important; width: 0.9em; height: 0.9em;
                position: relative; vertical-align: middle; background-color: #fff !important;
            }
            .option-group input[type="checkbox"]:checked::before {
                content: "✔"; font-size: 0.8em; color: #000 !important;
                position: absolute; top: 50%; left: 50%; transform: translate(-50%, -52%); line-height: 1;
            }
            .option-group input[type="radio"]:checked::before {
                content: "●"; font-size: 0.8em; color: #000 !important;
                position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); line-height: 1;
            }
            textarea, input[type="text"].other-text {
                border: 1px solid #777 !important; background-color: #f9f9f9 !important;
                padding: 6px; font-size: 10pt; width: 100%; color: #000 !important;
            }
            textarea::placeholder, input[type="text"].other-text::placeholder { color: #666 !important; }
            textarea { min-height: 50px; }
            .buttons-container, footer, .submission-note { display: none !important; } 
        }
    </style>
</head>
<body>
    <div class="container" id="surveyContainer">
        <header>
            <h1>房地产中介需求调研问卷</h1>
            <p>感谢Linda Yu抽出宝贵时间填写。您的反馈对我非常重要，将帮助我为您量身打造最合适的系统！</p>
        </header>

        <form id="surveyForm" class="survey-form">
            <h2>第一部分：您当前的系统使用情况</h2>

            <div class="question-block">
                <label class="main-label">1. 您对当前的官方数据库管理系统，主要不满意的地方是？ (可多选)</label>
                <div class="option-group" id="q1_unsatisfied">
                    <label><input type="checkbox" name="q1_unsatisfied_options" value="数据录入/修改不方便"><span></span> 数据录入/修改不方便 (如步骤繁琐、字段不合理)</label>
                    <label><input type="checkbox" name="q1_unsatisfied_options" value="查询/筛选功能弱"><span></span> 查询/筛选功能弱 (如找不到信息、条件有限、慢)</label>
                    <label><input type="checkbox" name="q1_unsatisfied_options" value="无法按需定制报表或视图"><span></span> 无法按需定制报表或视图</label>
                    <label><input type="checkbox" name="q1_unsatisfied_options" value="系统运行速度慢"><span></span> 系统运行速度慢，影响效率</label>
                    <label><input type="checkbox" name="q1_unsatisfied_options" value="无法与其他常用工具顺畅集成"><span></span> 无法与其他常用工具顺畅集成</label>
                    <label><input type="checkbox" name="q1_unsatisfied_options" value="移动端访问和操作不便"><span></span> 移动端(手机/平板)访问和操作不便</label>
                    <label><input type="checkbox" name="q1_unsatisfied_options" value="数据安全或隐私方面有顾虑"><span></span> 数据安全或隐私方面有顾虑</label>
                    <label><input type="checkbox" name="q1_unsatisfied_options_other_checkbox" value="其他_q1"><span></span> 其他 (请说明)：
                        <input type="text" name="q1_unsatisfied_other_text" class="other-text" placeholder="请具体说明">
                    </label>
                </div>
            </div>

            <div class="question-block">
                <label class="main-label">2. 除了官方系统，您目前还管理着哪些独立的数据库或数据文件？ (可多选)</label>
                <div class="option-group" id="q2_independent_db">
                    <label><input type="checkbox" name="q2_independent_db_options" value="Excel表格"><span></span> Excel表格</label>
                    <label><input type="checkbox" name="q2_independent_db_options" value="CSV文件"><span></span> CSV文件</label>
                    <label><input type="checkbox" name="q2_independent_db_options" value="Access数据库"><span></span> Access数据库</label>
                    <label><input type="checkbox" name="q2_independent_db_options" value="纸质记录"><span></span> 纸质记录</label>
                    <label><input type="checkbox" name="q2_independent_db_options" value="其他本地软件"><span></span> 其他本地软件</label>
                     <label><input type="checkbox" name="q2_independent_db_options_other_checkbox" value="其他_q2"><span></span> 其他 (请说明)：
                        <input type="text" name="q2_independent_db_other_text" class="other-text" placeholder="请具体说明">
                    </label>
                </div>
            </div>

            <div class="question-block">
                <label class="main-label">3. 使用这些不同的数据库/文件时，您遇到的主要困扰是？ (可多选)</label>
                <div class="option-group" id="q3_db_issues">
                    <label><input type="checkbox" name="q3_db_issues_options" value="数据分散，查找信息需在多处切换"><span></span> 数据分散，查找信息需在多处切换</label>
                    <label><input type="checkbox" name="q3_db_issues_options" value="数据格式不统一，难以整合分析"><span></span> 数据格式不统一，难以整合分析</label>
                    <label><input type="checkbox" name="q3_db_issues_options" value="大量重复录入或数据冗余"><span></span> 大量重复录入或数据冗余</label>
                    <label><input type="checkbox" name="q3_db_issues_options" value="容易出现数据不一致或版本错误"><span></span> 容易出现数据不一致或版本错误</label>
                    <label><input type="checkbox" name="q3_db_issues_options" value="数据更新和维护工作量大"><span></span> 数据更新和维护工作量大</label>
                    <label><input type="checkbox" name="q3_db_issues_options_other_checkbox" value="其他_q3"><span></span> 其他 (请说明)：
                        <input type="text" name="q3_db_issues_other_text" class="other-text" placeholder="请具体说明">
                    </label>
                </div>
            </div>

            <h2>第二部分：您对新系统的愿景与核心需求</h2>

            <div class="question-block">
                <label for="q4_vision" class="main-label">4. 您对将要为您打造的这个专属数据库(或客户管理系统)的愿景是什么样的？最核心的功能应该有哪些？</label>
                <textarea id="q4_vision" name="q4_vision" placeholder="例如：高效管理客户信息、精细化管理房源、跟进销售过程、自动生成报告、提醒待办事项等。希望它能如何帮助您提高工作效率。"></textarea>
            </div>

            <div class="question-block">
                <label class="main-label">5. 在新系统中，您最看重哪些特性？ (可多选，请选出最重要的3-5项)</label>
                <div class="option-group" id="q5_key_features">
                    <label><input type="checkbox" name="q5_key_features_options" value="操作界面简洁易用，上手快"><span></span> 操作界面简洁易用，上手快</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="数据录入高效便捷"><span></span> 数据录入高效便捷 (如支持批量操作、智能填充)</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="强大的搜索和筛选功能"><span></span> 强大的搜索和筛选功能 (快速、多维度)</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="灵活的自定义字段和视图"><span></span> 灵活的自定义字段和视图</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="移动端访问流畅"><span></span> 移动端访问流畅 (手机/平板)</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="数据绝对安全，有可靠的备份机制"><span></span> 数据绝对安全，有可靠的备份机制</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="能生成我需要的统计报表"><span></span> 能生成我需要的统计报表 (可自定义)</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="能与其他工具集成"><span></span> 能与其他工具集成 (如日历、邮件)</label>
                    <label><input type="checkbox" name="q5_key_features_options" value="任务和日程提醒功能"><span></span> 任务和日程提醒功能 (智能化)</label>
                    <label><input type="checkbox" name="q5_key_features_options_other_checkbox" value="其他_q5"><span></span> 其他 (请说明)：
                        <input type="text" name="q5_key_features_other_text" class="other-text" placeholder="请具体说明">
                    </label>
                </div>
            </div>
            
            <div class="question-block">
                <label class="main-label">6. 新系统的部署方式，您更倾向于哪种？
                    <small>“云端/服务器”指数据存在专业服务器上，通过浏览器访问，通常更稳定且易于多设备访问。“本地电脑”指系统安装在您的个人电脑上。</small>
                </label>
                <div class="option-group" id="q6_deployment_preference">
                    <label><input type="radio" name="q6_deployment_options" value="云端/服务器部署"><span></span> 云端/服务器部署 (例如，像使用Xero或Gmail那样)</label>
                    <label><input type="radio" name="q6_deployment_options" value="本地电脑部署"><span></span> 安装在您的本地电脑上</label>
                    <label><input type="radio" name="q6_deployment_options" value="需要更多信息来决定"><span></span> 需要更多信息来决定/不确定</label>
                </div>
            </div>

            <div class="question-block">
                <label class="main-label">7. (可选) 如果新系统能加入一些“智能助手”功能（例如自动填写信息、智能推荐房源、辅助撰写营销文案等），您会感兴趣吗？
                     <small>这可能与部署方式有关，例如本地部署可能更容易使用某些免费的AI模型。</small>
                </label>
                <div class="option-group" id="q7_ai_interest">
                    <label><input type="radio" name="q7_ai_interest_options" value="非常感兴趣"><span></span> 非常感兴趣，希望了解更多</label>
                    <label><input type="radio" name="q7_ai_interest_options" value="有点兴趣"><span></span> 有点兴趣，可以考虑</label>
                    <label><input type="radio" name="q7_ai_interest_options" value="目前更关注核心功能"><span></span> 目前更关注核心功能，以后再说</label>
                    <label><input type="radio" name="q7_ai_interest_options" value="不太感兴趣"><span></span> 不太感兴趣</label>
                </div>
            </div>


            <h2>第三部分：您的日常工作与期望</h2>

            <div class="question-block">
                <label for="q8_pain_points_workflow" class="main-label">8. 在您日常与客户和房源数据打交道的流程中，哪些环节最耗时、最繁琐或最容易出错？新系统如何能帮助您改善？</label>
                <textarea id="q8_pain_points_workflow" name="q8_pain_points_workflow" placeholder="例如：客户信息录入、房源匹配、合同准备、数据同步等环节。"></textarea>
            </div>

            <div class="question-block">
                <label for="q9_ideal_system_words" class="main-label">9. 如果用三个词来形容您理想中的新系统，您会选择哪三个词？</label>
                <input type="text" id="q9_ideal_system_words" name="q9_ideal_system_words" class="other-text" placeholder="例如：高效、智能、可靠">
            </div>

            <div class="question-block">
                <label for="q10_additional_thoughts" class="main-label">10. 关于这个新系统，您还有没有其他特别的想法、需求或者顾虑希望我了解？</label>
                <textarea id="q10_additional_thoughts" name="q10_additional_thoughts" placeholder="任何您觉得重要但尚未提及的内容都可以写在这里。"></textarea>
            </div>

            <div class="buttons-container">
                <p class="submission-note">您可以将问卷打印出来，手写之后拍照发给我，或者将回复下载为HTML保存到电脑上，然后发到我微信或邮箱 rousesoul@gmail.com</p>
                <button type="button" class="button button-secondary" onclick="window.print()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"></path></svg>
                    打印问卷
                </button>
                <button type="button" id="downloadHtmlReply" class="button button-primary"> <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" viewBox="0 0 24 24" fill="currentColor"><g><rect fill="none" height="24" width="24"/></g><g><path d="M14,2H6C4.9,2,4,2.9,4,4v16c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V8L14,2z M12,19c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,19,12,19z M15,9H5V5h9V9z"/></g></svg>
                    下载回复 (HTML)
                </button>
            </div>
        </form>
        <footer>
            <p>&copy; <span id="currentYear"></span> 为 Linda Yu 定制。由 Winston Lin (022 0823241) 设计与支持。</p>
            <p>如有任何疑问，请随时联系 Winston Lin。</p>
        </footer>
    </div>

    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        const surveyForm = document.getElementById('surveyForm');
        
        function getFormattedAnswer(questionData) {
            const { blockId, optionsName, otherCheckboxValuePrefix, otherTextName, radioName, textareaId, inputId, defaultText = '未选择' } = questionData;
            const questionBlock = document.getElementById(blockId) || surveyForm;
            let answerText = defaultText;

            if (optionsName) { 
                const checkboxes = questionBlock.querySelectorAll(`input[name="${optionsName}"]:checked`);
                let values = [];
                checkboxes.forEach(checkbox => {
                    const associatedOtherTextLabel = checkbox.closest('label');
                    const associatedOtherTextInput = associatedOtherTextLabel ? associatedOtherTextLabel.querySelector(`input[name="${otherTextName}"]`) : null;
                    if (checkbox.value.startsWith(otherCheckboxValuePrefix) || (associatedOtherTextInput && checkbox.checked)) {
                        const otherText = questionBlock.querySelector(`input[name="${otherTextName}"]`).value;
                        values.push(otherText.trim() !== "" ? `其他: ${otherText.trim()}` : `其他 (已勾选但未填写)`);
                    } else {
                        values.push(checkbox.value);
                    }
                });
                if (values.length > 0) answerText = values.join('; ');
            } else if (radioName) { 
                const radio = surveyForm.querySelector(`input[name="${radioName}"]:checked`);
                if (radio) answerText = radio.value;
            } else if (textareaId) { 
                const textarea = surveyForm.querySelector(`#${textareaId}`);
                if (textarea && textarea.value.trim() !== "") answerText = textarea.value.trim();
                else if (textarea && textarea.value.trim() === "") answerText = '未填写';
            } else if (inputId) { 
                const input = surveyForm.querySelector(`#${inputId}`);
                if (input && input.value.trim() !== "") answerText = input.value.trim();
                else if (input && input.value.trim() === "") answerText = '未填写';
            }
            return answerText;
        }
        
        const allQuestions = [
            { no: 1, label: "您对当前的官方数据库管理系统，主要不满意的地方是？", blockId: 'q1_unsatisfied', optionsName: 'q1_unsatisfied_options', otherCheckboxValuePrefix: '其他_q1', otherTextName: 'q1_unsatisfied_other_text' },
            { no: 2, label: "除了官方系统，您目前还管理着哪些独立的数据库或数据文件？", blockId: 'q2_independent_db', optionsName: 'q2_independent_db_options', otherCheckboxValuePrefix: '其他_q2', otherTextName: 'q2_independent_db_other_text' },
            { no: 3, label: "使用这些不同的数据库/文件时，您遇到的主要困扰是？", blockId: 'q3_db_issues', optionsName: 'q3_db_issues_options', otherCheckboxValuePrefix: '其他_q3', otherTextName: 'q3_db_issues_other_text' },
            { no: 4, label: "您对将要为您打造的这个专属数据库(或客户管理系统)的愿景是什么样的？最核心的功能应该有哪些？", textareaId: 'q4_vision' },
            { no: 5, label: "在新系统中，您最看重哪些特性？ (最重要的3-5项)", blockId: 'q5_key_features', optionsName: 'q5_key_features_options', otherCheckboxValuePrefix: '其他_q5', otherTextName: 'q5_key_features_other_text' },
            { no: 6, label: "新系统的部署方式，您更倾向于哪种？", radioName: 'q6_deployment_options' },
            { no: 7, label: "(可选) 如果新系统能加入一些“智能助手”功能，您会感兴趣吗？", radioName: 'q7_ai_interest_options' },
            { no: 8, label: "在您日常与客户和房源数据打交道的流程中，哪些环节最耗时、最繁琐或最容易出错？新系统如何能帮助您改善？", textareaId: 'q8_pain_points_workflow' },
            { no: 9, label: "如果用三个词来形容您理想中的新系统，您会选择哪三个词？", inputId: 'q9_ideal_system_words' },
            { no: 10, label: "关于这个新系统，您还有没有其他特别的想法、需求或者顾虑希望我了解？", textareaId: 'q10_additional_thoughts' }
        ];

        function generateHtmlReplyContent() {
            let htmlReply = `
                <!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>问卷回复 - Linda Yu</title>
                <style>
                    body { font-family: 'Roboto', -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; margin: 0; padding:0; background-color: #FDFEFE; color: #1B1C1E; }
                    .survey-reply-container { max-width: 800px; margin: 20px auto; background-color: #fff; padding: 20px 30px; border-radius: 16px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
                    .survey-reply-header h1 { color: #3A506B; font-size: 24px; margin-bottom:10px; padding-bottom:10px; border-bottom:1px solid #CFD8DC; }
                    .survey-reply-header p {font-size:14px; color:#43474E; margin-bottom:20px;}
                    .survey-reply-section h2 { color: #E57373; font-size: 20px; margin-top: 25px; margin-bottom: 15px; padding-bottom:5px; border-bottom:1px solid #F5F7F8;}
                    .survey-reply-question { font-weight: 500; margin-top: 18px; color: #1B1C1E; font-size:16px; }
                    .survey-reply-answer { margin-left: 0px; padding: 8px 0px 12px 0px; color: #43474E; white-space: pre-wrap; word-wrap: break-word; font-size:15px; border-bottom:1px dotted #CFD8DC; }
                    .survey-reply-answer:last-child {border-bottom:none;}
                    .survey-reply-answer.empty { color: #73777F; font-style: italic; }
                </style>
                </head><body class="survey-reply-body"><div class="survey-reply-container">
                <div class="survey-reply-header"><h1>房地产中介需求调研问卷 - 回复</h1><p><strong>填写人:</strong> Linda Yu</p></div>
            `;
            let currentSection = "";
            allQuestions.forEach(q => {
                if (q.no === 1 && currentSection !== "第一部分") { htmlReply += `<div class="survey-reply-section"><h2>第一部分：您当前的系统使用情况</h2></div>`; currentSection = "第一部分"; }
                else if (q.no === 4 && currentSection !== "第二部分") { htmlReply += `<div class="survey-reply-section"><h2>第二部分：您对新系统的愿景与核心需求</h2></div>`; currentSection = "第二部分"; }
                else if (q.no === 8 && currentSection !== "第三部分") { htmlReply += `<div class="survey-reply-section"><h2>第三部分：您的日常工作与期望</h2></div>`; currentSection = "第三部分"; }
                
                const answer = getFormattedAnswer(q);
                htmlReply += `<div class="survey-reply-question">${q.no}. ${q.label}</div>`;
                htmlReply += `<div class="survey-reply-answer ${answer === '未选择' || answer === '未填写' ? 'empty' : ''}">${answer.replace(/\n/g, '<br>')}</div>`;
            });
            htmlReply += `</div></body></html>`;
            return htmlReply;
        }

        document.getElementById('downloadHtmlReply').addEventListener('click', function() {
            const htmlContent = generateHtmlReplyContent();
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '问卷回复-Linda_Yu.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert("包含答案的HTML文件已开始下载。下载完成后，请通过邮件附件或微信发送给我。谢谢！");
        });

        function setupOtherOption(checkboxNameAttribute, textInputName) {
            const otherCheckbox = document.querySelector(`input[name="${checkboxNameAttribute}"]`);
            if (otherCheckbox) {
                const labelParent = otherCheckbox.closest('label');
                const textInput = labelParent ? labelParent.querySelector(`input[name="${textInputName}"]`) : null;
                if (textInput) {
                    textInput.disabled = !otherCheckbox.checked; 
                    otherCheckbox.addEventListener('change', function() {
                        textInput.disabled = !this.checked;
                        if (!this.checked) { textInput.value = ''; } 
                        else { textInput.focus(); }
                    });
                }
            }
        }
        setupOtherOption('q1_unsatisfied_options_other_checkbox', 'q1_unsatisfied_other_text');
        setupOtherOption('q2_independent_db_options_other_checkbox', 'q2_independent_db_other_text');
        setupOtherOption('q3_db_issues_options_other_checkbox', 'q3_db_issues_other_text');
        setupOtherOption('q5_key_features_options_other_checkbox', 'q5_key_features_other_text');

        document.querySelectorAll('.text-field-container textarea, .text-field-container input[type="text"].other-text').forEach(input => {
            const label = input.parentNode.querySelector('label.text-field-label');
            if (label) {
                const checkValueAndToggleLabel = () => {
                    if (input.value.trim() !== '' || document.activeElement === input ) { 
                        label.style.top = '6px'; 
                        label.style.fontSize = '12px';
                        label.style.color = 'var(--linda-primary-color)';
                    } else if (input.placeholder.trim() === '') { 
                         label.style.top = '16px';
                         label.style.fontSize = '16px';
                         label.style.color = 'var(--linda-on-surface-variant-color)';
                    }
                };
                checkValueAndToggleLabel(); 
                input.addEventListener('focus', checkValueAndToggleLabel);
                input.addEventListener('blur', checkValueAndToggleLabel);
                input.addEventListener('input', checkValueAndToggleLabel); 
            }
        });
    </script>
</body>
</html>
